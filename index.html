<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelado Matemático de Enfermedades Infecciosas - ISP Javeriana</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --javeriana-yellow: #FFCD00;
            --javeriana-blue: #0033A0;
            --javeriana-gray: #75787B;
            --text-dark: #1f2937;
            --text-medium: #4b5563;
            --bg-light: #f9fafb;
            --border-color: #d1d5db;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
        }
        .container { max-width: 1100px; margin: 2rem auto; padding: 2rem; }
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }
        .logo-container img {
            height: 60px;
            max-width: 200px;
            object-fit: contain;
        }
        .main-title { font-size: 2.25rem; font-weight: 700; color: var(--javeriana-blue); text-align: center; margin-bottom: 0.25rem; }
        .institutional-credit { font-size: 0.9rem; color: var(--javeriana-gray); text-align: center; margin-bottom: 0.5rem; }
        .subtitle { font-size: 1.25rem; color: var(--text-medium); text-align: center; margin-bottom: 2.5rem; }
        .section-title { font-size: 1.75rem; font-weight: 700; color: var(--javeriana-blue); margin-top: 3rem; margin-bottom: 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--javeriana-yellow); }
        
        .content-card { background-color: #ffffff; border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.07); }
        .content-card h3 { font-size: 1.375rem; font-weight: 600; color: var(--javeriana-blue); margin-bottom: 1rem; }
        
        /* Dynamic SIR Step-by-Step Styles */
        .sir-simulation-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background-color: #fff;
            margin-bottom: 1.5rem;
            position: relative; 
        }
        .sir-compartments {
            display: flex;
            justify-content: space-around; 
            width: 100%;
            margin-bottom: 1rem;
            min-height: 150px; 
            position: relative; 
        }
        .compartment {
            width: 28%; 
            padding: 0.5rem;
            border: 2px dashed var(--javeriana-gray);
            border-radius: 0.375rem;
            text-align: center;
            position: relative; 
            z-index: 1; 
            background-color: #fff; 
        }
        .compartment-title { font-weight: 600; color: var(--javeriana-blue); }
        .individuals-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 4px; padding: 0.5rem; }
        .individual-icon { width: 16px; height: 16px; transition: fill 0.5s ease; }
        .susceptible { fill: #60a5fa; }
        .infected { fill: #f87171; }
        .recovered { fill: #34d399; }

        .flow-arrow { position: absolute; font-size: 1.8rem; color: var(--javeriana-blue); z-index: 0; opacity: 0; transition: opacity 0.5s ease-in-out; }
        .flow-label { position: absolute; font-family: 'Menlo', 'Monaco', 'Courier New', monospace; font-size: 0.85rem; color: var(--javeriana-blue); background-color: rgba(255, 255, 255, 0.85); padding: 3px 5px; border-radius: 3px; border: 1px solid #e0e7ff; z-index: 2; opacity: 0; transition: opacity 0.5s ease-in-out; white-space: nowrap; font-weight: 500; }

        #arrow-birth-s { top: 50%; left: -2%; transform: translateY(-50%); font-size:1.5rem; } 
        #label-birth-s { top: 30%; left: -1%; transform: translateX(0) translateY(-50%); } 
        #arrow-s-i { top: 50%; left: 32.5%; transform: translateX(-50%) translateY(-50%); } 
        #label-s-i { top: 25%; left: 32.5%; transform: translateX(-50%) translateY(-50%); }
        #arrow-i-r { top: 50%; left: 67.5%; transform: translateX(-50%) translateY(-50%); } 
        #label-i-r { top: 25%; left: 67.5%; transform: translateX(-50%) translateY(-50%); }
        #arrow-death-s { bottom: -5px; left: 15%; transform: translateX(-50%) rotate(90deg); font-size:1.5rem; } 
        #label-death-s { bottom: -25px; left: 15%; transform: translateX(-50%); }
        #arrow-death-i { bottom: -5px; left: 50%; transform: translateX(-50%) rotate(90deg); font-size:1.5rem; } 
        #label-death-i { bottom: -25px; left: 50%; transform: translateX(-50%); }
        #arrow-death-r { bottom: -5px; left: 85%; transform: translateX(-50%) rotate(90deg); font-size:1.5rem; } 
        #label-death-r { bottom: -25px; left: 85%; transform: translateX(-50%); }

        .sir-controls button { background-color: var(--javeriana-blue); color: white; padding: 0.7rem 1.3rem; border-radius: 0.375rem; font-weight: 500; cursor: pointer; transition: background-color 0.2s; margin: 0.5rem 0.5rem; }
        .sir-controls button:hover { background-color: #002269; }
        .sir-controls button:disabled { background-color: #a5b4fc; cursor: not-allowed; }
        .sir-explanation { margin-top: 1.5rem; padding: 1rem; background-color: #f3f4f6; border-radius: 0.375rem; width: 100%; text-align: left; font-size: 0.9rem; border-left: 4px solid var(--javeriana-yellow); }
        .sir-explanation p { margin-bottom: 0.5rem; }
        .sir-explanation h4 { font-size: 1.1rem; font-weight: 600; color: var(--javeriana-blue); margin-bottom: 0.75rem; }

        /* Parameter Accordion Styles */
        .parameter-button { background-color: #ffffff; border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 1rem 1.5rem; width: 100%; text-align: left; font-size: 1.125rem; font-weight: 600; color: var(--javeriana-blue); margin-bottom: 1rem; cursor: pointer; transition: background-color 0.2s, border-color 0.2s; display: flex; justify-content: space-between; align-items: center; }
        .parameter-button:hover { background-color: #eff6ff; border-color: var(--javeriana-blue); }
        .parameter-button .arrow { transition: transform 0.3s ease; font-size: 1.25rem; color: var(--javeriana-blue); }
        .parameter-button.active .arrow { transform: rotate(90deg); }
        .parameter-content { background-color: #ffffff; border: 1px solid var(--border-color); border-top: none; border-radius: 0 0 0.5rem 0.5rem; padding: 1.5rem; margin-top: -1rem; margin-bottom: 1.5rem; display: none; }
        .parameter-content.show { display: block; }
        .parameter-content .content-wrapper { display: flex; flex-direction: column; md:flex-row; gap: 1.5rem; align-items: flex-start; }
        .parameter-text { flex: 2; } 
        .parameter-graphic { flex: 1; display: flex; justify-content: center; align-items: center; padding-top: 1rem; min-width: 150px; }
        .parameter-graphic img { width: 100%; max-width: 300px; height: auto; border-radius: 0.25rem;}
        .parameter-content h4 { font-size: 1.05rem; font-weight: 600; color: var(--text-dark); margin-bottom: 0.5rem; }
        .parameter-content p, .parameter-content li { font-size: 0.95rem; color: var(--text-medium); line-height: 1.6; margin-bottom: 0.5rem; }
        .formula, .equation { font-family: 'Menlo', 'Monaco', 'Courier New', monospace; background-color: #f3f4f6; padding: 0.75rem; border-radius: 0.375rem; margin-top: 0.5rem; display: block; overflow-x: auto; font-size: 0.9rem; border: 1px solid #e5e7eb; }

        .model-display-wrapper { display: flex; flex-direction: column; md:flex-row; gap: 1.5rem; align-items: flex-start; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="images/logoinstituto.png" alt="Logo Instituto de Salud Pública">
                <img src="images/logojaveriana.png" alt="Logo Pontificia Universidad Javeriana">
                <img src="images/Logo-ces.png" alt="Logo Universidad CES">
            </div>
            <h1 class="main-title">Modelado Matemático de Enfermedades Infecciosas</h1>
            <p class="institutional-credit">Una herramienta conceptual desarrollada para el Instituto de Salud Pública, Pontificia Universidad Javeriana</p>
            <p class="subtitle">Descomposición Conceptual de Parámetros y Modelos</p>
        </header>

        <section id="sir-model-dynamic" class="mt-6">
            <h2 class="section-title">El Modelo SIR: Una Visión Dinámica con Dinámica Vital</h2>
            <div class="sir-simulation-container">
                <h3>Visualizando el Flujo Compartimental</h3>
                <div class="sir-compartments">
                    <div id="arrow-birth-s" class="flow-arrow">➔</div> <div id="label-birth-s" class="flow-label">Λ o B</div>
                    
                    <div class="compartment" id="s-compartment">
                        <div class="compartment-title">Susceptibles (S)</div>
                        <div class="individuals-container" id="s-individuals"></div>
                    </div>
                    <div id="arrow-s-i" class="flow-arrow">➔</div> <div id="label-s-i" class="flow-label">βSI/N</div>
                    <div class="compartment" id="i-compartment">
                        <div class="compartment-title">Infectados (I)</div>
                        <div class="individuals-container" id="i-individuals"></div>
                    </div>
                    <div id="arrow-i-r" class="flow-arrow">➔</div> <div id="label-i-r" class="flow-label">γI</div>
                    <div class="compartment" id="r-compartment">
                        <div class="compartment-title">Recuperados (R)</div>
                        <div class="individuals-container" id="r-individuals"></div>
                    </div>

                    <div id="arrow-death-s" class="flow-arrow">➔</div> <div id="label-death-s" class="flow-label">μS</div>
                    <div id="arrow-death-i" class="flow-arrow">➔</div> <div id="label-death-i" class="flow-label">μI</div>
                    <div id="arrow-death-r" class="flow-arrow">➔</div> <div id="label-death-r" class="flow-label">μR</div>
                </div>
                <div class="sir-controls">
                    <button id="reset-sir" onclick="resetSimulation()">Reiniciar</button>
                    <button id="next-step-sir" onclick="nextSirStep()">Siguiente Paso</button>
                </div>
                <div class="sir-explanation" id="sir-step-explanation">
                    <p>Haz clic en "Siguiente Paso" para ver cómo se desarrolla la simulación, incluyendo nacimientos y muertes naturales.</p>
                </div>
            </div>
            <div class="content-card">
                 <h3>Ecuaciones del Modelo SIR con Dinámica Vital</h3>
                <p>El flujo dinámico que observas, ahora incluyendo nacimientos y muertes naturales, se rige por:</p>
                <code class="equation">dS/dt = Λ - (β × S × I) / N - μS</code>
                <code class="equation">dI/dt = (β × S × I) / N - γI - μI</code>
                <code class="equation">dR/dt = γI - μR</code>
                <p>Donde: <span class="parameter-highlight">Λ (o B)</span> es la tasa de natalidad, y <span class="parameter-highlight">μ</span> es la tasa de mortalidad natural per cápita, aplicada a cada compartimento. N (S+I+R) ahora puede cambiar con el tiempo.</p>
            </div>
        </section>

        <section id="parameters">
            <h2 class="section-title">Parámetros Epidemiológicos Fundamentales</h2>
            
            <button class="parameter-button" onclick="toggleParameter('birthRateContent')"><span>Tasa de Natalidad y Mortalidad (Dinámica Vital)</span><span class="arrow">&#9654;</span></button>
            <div id="birthRateContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>La **Tasa de Natalidad (Λ o B)** representa la tasa a la que nuevos individuos (susceptibles) se añaden a la población. La **Tasa de Mortalidad Natural (μ)** es la tasa per cápita a la que los individuos mueren por causas no relacionadas con la enfermedad.</p><h4>Relevancia:</h4><p>Para enfermedades endémicas a largo plazo, la reposición de susceptibles a través de nacimientos es crucial para la transmisión sostenida. Es importante destacar que en Colombia, la tasa de natalidad ha disminuido significativamente en los últimos años.</p></div><div class="parameter-graphic"><img src="images/EstadisticaVital.png" alt="Gráfico de Estadísticas Vitales"></div></div></div>

            <button class="parameter-button" onclick="toggleParameter('betaContent')"><span>Tasa de Transmisión (β - beta)</span><span class="arrow">&#9654;</span></button>
            <div id="betaContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>La tasa a la cual un individuo infeccioso genera nuevas infecciones.</p><h4>Relevancia:</h4><p>Un β alto indica que la enfermedad se propaga fácilmente. Un ejemplo claro es el **COVID-19**: la variante original tenía un R₀ de ~2.5, la variante Delta de ~7, y Ómicron de ~10, en gran parte debido a un aumento en la tasa de transmisión β de cada variante.</p><h4>Fórmula:</h4><code class="formula">β = k × p</code></div><div class="parameter-graphic"><img src="images/Beta CovidVariantes.png" alt="Ejemplo de R₀ para variantes de COVID"></div></div></div>

            <button class="parameter-button" onclick="toggleParameter('r0Content')"><span>Número Básico de Reproducción (R₀)</span><span class="arrow">&#9654;</span></button>
            <div id="r0Content" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>El número promedio de infecciones secundarias causadas por un único individuo infeccioso en una población completamente susceptible.</p><h4>Relevancia:</h4><p>Es el umbral crítico. Si R₀ > 1, la epidemia crece. Por ejemplo, el **Ébola** con un R₀ de 2 es muy grave pero menos transmisible que el **COVID-19** (variante Delta*) con un R₀ de 4, que a su vez es menos transmisible que el sarampión. (*Ejemplo didáctico).</p><h4>Fórmula:</h4><code class="formula">R₀ = β / γ</code></div><div class="parameter-graphic"><img src="images/Ro-ejemplo.png" alt="Ejemplo de R₀ para Ébola y COVID-19"></div></div></div>

            <button class="parameter-button" onclick="toggleParameter('incubContent')"><span>Periodo de Incubación y Latente</span><span class="arrow">&#9654;</span></button>
            <div id="incubContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>El **Periodo de Incubación** es el tiempo desde la infección hasta la aparición de los síntomas. El **Periodo Latente** es el tiempo hasta que la persona se vuelve infecciosa.</p><h4>Relevancia:</h4><p>Varía mucho: **Ébola** (2-21 días), **COVID-19** (hasta 14 días), **Sarampión** (10-14 días). Es crucial para definir cuarentenas. Si el periodo latente es más corto que el de incubación, ocurre transmisión presintomática.</p></div><div class="parameter-graphic"><img src="images/DinamicaCOVID.png" alt="Ejemplo de Dinámica de COVID-19"></div></div></div>

            <button class="parameter-button" onclick="toggleParameter('genTimeContent')"><span>Tiempo de Generación e Intervalo Serial</span><span class="arrow">&#9654;</span></button>
            <div id="genTimeContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>El **Tiempo de Generación** es el tiempo entre la infección de un caso y sus casos secundarios. El **Intervalo Serial** es el tiempo entre los *síntomas* de un caso y sus casos secundarios.</p><h4>Relevancia:</h4><p>El intervalo serial es la medida observable que aproxima el tiempo de generación. Para la **gripe**, ambos son muy cortos (2-3 días), lo que explica su rápida propagación.</p></div><div class="parameter-graphic"><img src="images/IntervaloSerial.jpg" alt="Diagrama de Intervalo Serial y Tiempo de Generación"></div></div></div>
            
            <button class="parameter-button" onclick="toggleParameter('attackRateContent')"><span>Tasa de Ataque</span><span class="arrow">&#9654;</span></button>
            <div id="attackRateContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>La proporción de una población en riesgo que contrae la enfermedad durante un brote específico.</p><h4>Relevancia:</h4><p>Mide la infectividad en un grupo definido. En un brote de **norovirus** en un crucero, puede ser del 40%. Para el **sarampión** en una escuela de no vacunados, puede superar el 90%.</p><h4>Fórmula:</h4><code class="formula">Tasa de Ataque = (Nuevos Casos) / (Población en Riesgo al Inicio)</code></div><div class="parameter-graphic"><img src="images/AttackRatio.png" alt="Ejemplo de Tasa de Ataque"></div></div></div>

            <button class="parameter-button" onclick="toggleParameter('cfrContent')"><span>Tasa de Letalidad (CFR) y Tasa de Mortalidad por Infección (IFR)</span><span class="arrow">&#9654;</span></button>
            <div id="cfrContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>El **CFR** es la proporción de muertes entre los casos *confirmados*. El **IFR** es la proporción de muertes entre *todas* las infecciones (incluidas las no diagnosticadas).</p><h4>Relevancia:</h4><p>El IFR es una medida más precisa de la severidad real. Para el **COVID-19**, el CFR inicial era alto, pero el IFR era menor debido a la gran cantidad de casos asintomáticos.</p><h4>Fórmula:</h4><code class="formula">IFR = (Muertes) / (Total de Infecciones)</code></div><div class="parameter-graphic"><img src="images/CFR.png" alt="Ejemplo de Tasa de Letalidad"></div></div></div>
        </section>
        
        <section id="vector-borne-models" class="mt-6">
            <h2 class="section-title">Dinámica de Enfermedades Transmitidas por Vectores</h2>
            <div class="content-card">
                 <div class="flex flex-col md:flex-row gap-8 items-center">
                    <div class="flex-1">
                        <h3>Modelado de Infecciones por Vectores</h3>
                        <p>Enfermedades como el dengue o el Zika son transmitidas por vectores (ej. mosquitos). Su modelado es más complejo, ya que requiere parámetros para la dinámica del vector y su interacción con los humanos.</p>
                        <p class="mt-4">Abajo encontrarás la definición de los parámetros clave en este tipo de transmisión.</p>
                    </div>
                    <div class="flex-1 flex justify-center items-center">
                        <svg class="w-56 h-56 text-gray-700" viewBox="0 0 100 100">
                            <g transform="translate(20 20) scale(0.5)"><path d="M21.9 16.9C21.1 16.1 20.1 16 19 16h-1a3 3 0 00-3-3V9a1 1 0 00-1-1h-2a1 1 0 00-1 1v4a1 1 0 001 1h2a1 1 0 011 1v1a1 1 0 01-1 1h-2a3 3 0 01-3-3V9a1 1 0 01-1-1H6a1 1 0 01-1-1V4a1 1 0 011-1h4a1 1 0 011 1v1" stroke="var(--text-dark)" stroke-width="3"></path><path d="M12 21v-3 M18 21v-3 M6 21v-3 M3 12h1 M19 3l-2 2 M2 20l2-2" stroke="var(--text-dark)" stroke-width="3"></path></g>
                             <path d="M45 40 L 60 55" stroke="var(--infected-color)" stroke-width="2" stroke-dasharray="3" marker-end="url(#svg-arrowhead)"></path>
                             <text x="50" y="45" font-size="8" fill="var(--infected-color)">PIE</text>
                            <g transform="translate(60 60) scale(1.5)"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" fill="var(--susceptible-color)"></path></g>
                        </svg>
                    </div>
                </div>
            </div>
            <button class="parameter-button" onclick="toggleParameter('eipContent')"><span>Periodo de Incubación Extrínseco (PIE)</span><span class="arrow">&#9654;</span></button>
            <div id="eipContent" class="parameter-content"><div class="content-wrapper"><div class="parameter-text"><h4>Definición:</h4><p>Tiempo que tarda el patógeno en replicarse dentro del vector (ej. mosquito) hasta que este puede transmitirlo. Es altamente sensible a la temperatura.</p></div><div class="parameter-graphic"><img src="images/EIP.png" alt="Ejemplo de Periodo de Incubación Extrínseco"></div></div></div>
        </section>

        <section id="other-models" class="mt-6">
            <h2 class="section-title">Más Allá del SIR: Otros Tipos de Modelos</h2>
            <div class="content-card">
                 <div class="model-display-wrapper"><div class="parameter-text"><h4>Modelo SEIR</h4><p>Añade un compartimento 'E' (Expuestos) para individuos infectados pero aún no infecciosos (periodo de incubación).</p></div><div class="parameter-graphic"><svg viewBox="0 0 200 80"><g transform="translate(0 10)"><path d="M20 40 L 50 40" stroke="#0033A0" stroke-width="1.5" marker-end="url(#svg-arrowhead)"></path><text x="32" y="35" font-size="8">λS</text><path d="M90 40 L 120 40" stroke="#0033A0" stroke-width="1.5" marker-end="url(#svg-arrowhead)"></path><text x="102" y="35" font-size="8">σE</text><path d="M160 40 L 190 40" stroke="#0033A0" stroke-width="1.5" marker-end="url(#svg-arrowhead)"></path><text x="172" y="35" font-size="8">γI</text><rect x="0" y="30" width="20" height="20" fill="#e0e7ff" stroke="#6366f1"></rect><text x="10" y="45" text-anchor="middle" font-size="10">S</text><rect x="60" y="30" width="20" height="20" fill="#fffbeb" stroke="#fBBF24"></rect><text x="70" y="45" text-anchor="middle" font-size="10">E</text><rect x="130" y="30" width="20" height="20" fill="#fee2e2" stroke="#f87171"></rect><text x="140" y="45" text-anchor="middle" font-size="10">I</text><rect x="180" y="50" width="20" height="20" fill="#d1fae5" stroke="#34d399"></rect><text x="190" y="65" text-anchor="middle" font-size="10">R</text></g></svg></div></div>
                <hr class="my-6">
                 <div class="model-display-wrapper"><div class="parameter-text"><h4>Modelo Estocástico</h4><p>Incorpora el azar. Es crucial para brotes pequeños, donde una infección puede extinguirse por casualidad. Cada línea representa un linaje de infección.</p></div><div class="parameter-graphic"><svg viewBox="0 0 100 60"><path d="M10 30 L 30 30" stroke="#f87171" stroke-width="1.5"></path><path d="M30 30 L 50 15" stroke="#f87171" stroke-width="1.5"></path><path d="M50 15 L 70 5" stroke="#a0aec0" stroke-width="1.5" stroke-dasharray="2"></path><text x="72" y="7" font-size="8">Extinto</text><path d="M50 15 L 70 25" stroke="#f87171" stroke-width="1.5"></path><path d="M30 30 L 50 45" stroke="#f87171" stroke-width="1.5"></path><path d="M50 45 L 70 35" stroke="#f87171" stroke-width="1.5"></path><path d="M50 45 L 70 55" stroke="#a0aec0" stroke-width="1.5" stroke-dasharray="2"></path><text x="72" y="57" font-size="8">Extinto</text></svg></div></div>
                <hr class="my-6">
                 <div class="model-display-wrapper"><div class="parameter-text"><h4>Modelo Basado en Agentes (ABM)</h4><p>Simula individuos ("agentes") con características y comportamientos únicos en un entorno. Permite modelar heterogeneidad y movimiento espacial.</p></div><div class="parameter-graphic"><svg viewBox="0 0 100 60"><rect width="100" height="60" fill="#f9fafb"></rect><circle cx="20" cy="20" r="5" fill="#60a5fa"></circle><circle cx="35" cy="45" r="5" fill="#f87171"></circle><circle cx="50" cy="15" r="5" fill="#60a5fa"></circle><circle cx="70" cy="30" r="5" fill="#60a5fa"></circle><circle cx="85" cy="50" r="5" fill="#34d399"></circle><path d="M35 45 L 22 23" stroke="#cbd5e1" stroke-width="1"></path><path d="M35 45 L 68 32" stroke="#cbd5e1" stroke-width="1"></path></svg></div></div>
            </div>
        </section>
        
        <section id="references" class="mt-6">
            <h2 class="section-title">Referencias</h2>
            <div class="content-card">
                <p>Esta presentación se basa en conceptos fundamentales del modelado epidemiológico. Para lecturas adicionales, considere estos tipos de recursos:</p>
                <ul class="list-disc list-inside space-y-2 text-sm">
                    <li>Pardo-Linares, J., & Usma-Gómez, L. F. (2014). Un modelo SIR para la epidemia de dengue en una ciudad de Colombia. *Revista de Salud Pública*, 16(2), 292-304. Disponible en: <a href="http://www.scielo.org.co/scielo.php?script=sci_arttext&pid=S0124-71072014000200009" target="_blank" class="text-blue-600 hover:underline">http://www.scielo.org.co/scielo.php?script=sci_arttext&pid=S0124-71072014000200009</a></li>
                    <li>Rojas-Alvarez, D. P., & Rodríguez-Morales, A. J. (2020). COVID-19 en Colombia: ¿Qué podemos esperar de la dinámica de la epidemia? *Revista de Salud Pública*, 22(2), 1-9. Disponible en: <a href="https://www.scielosp.org/article/rsap/2020.v22n2/123-131/" target="_blank" class="text-blue-600 hover:underline">https://www.scielosp.org/article/rsap/2020.v22n2/123-131/</a></li>
                    <li>Anderson RM, May RM. (1992). *Infectious diseases of humans: dynamics and control*. Oxford university press.</li>
                </ul>
            </div>
        </section>
    </div>

    <svg height="0" width="0"><defs><marker id="svg-arrowhead" markerWidth="5" markerHeight="4" refX="0" refY="2" orient="auto"><polygon points="0 0, 5 2, 0 4" fill="var(--javeriana-blue)" /></marker></defs></svg>

    <script>
        function toggleParameter(contentId) {
            const content = document.getElementById(contentId);
            const button = content.previousElementSibling;
            
            document.querySelectorAll('.parameter-content').forEach(item => {
                if (item.id !== contentId && item.classList.contains('show')) {
                    item.classList.remove('show');
                    if (item.previousElementSibling) {
                        item.previousElementSibling.classList.remove('active');
                    }
                }
            });

            content.classList.toggle('show');
            button.classList.toggle('active');
        }

       // --- Step-by-Step SIR Simulation Logic ---
        const sContainer = document.getElementById('s-individuals');
        const iContainer = document.getElementById('i-individuals');
        const rContainer = document.getElementById('r-individuals');
        const explanationDiv = document.getElementById('sir-step-explanation');
        const nextButton = document.getElementById('next-step-sir');

        const arrowBirthS = document.getElementById('arrow-birth-s');
        const labelBirthS = document.getElementById('label-birth-s');
        const arrowSToI = document.getElementById('arrow-s-i');
        const labelSToI = document.getElementById('label-s-i');
        const arrowIToR = document.getElementById('arrow-i-r');
        const labelIToR = document.getElementById('label-i-r');
        const arrowDeathS = document.getElementById('arrow-death-s');
        const labelDeathS = document.getElementById('label-death-s');
        const arrowDeathI = document.getElementById('arrow-death-i');
        const labelDeathI = document.getElementById('label-death-i');
        const arrowDeathR = document.getElementById('arrow-death-r');
        const labelDeathR = document.getElementById('label-death-r');

        let currentStep = 0;
        const totalInitialSusceptible = 15; 
        const initialInfected = 2;
        
        const personIconSVG = `<svg class="individual-icon" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>`;

        function createIndividualElement(status) {
            const div = document.createElement('div');
            div.innerHTML = personIconSVG;
            div.querySelector('svg').classList.add(status);
            return div;
        }

        function initializeIndividuals() {
            sContainer.innerHTML = '';
            iContainer.innerHTML = '';
            rContainer.innerHTML = '';
            for (let i = 0; i < totalInitialSusceptible; i++) { sContainer.appendChild(createIndividualElement('susceptible')); }
            for (let i = 0; i < initialInfected; i++) { iContainer.appendChild(createIndividualElement('infected')); }
        }
        
        function hideAllFlows() {
            [arrowBirthS, labelBirthS, arrowSToI, labelSToI, arrowIToR, labelIToR, arrowDeathS, labelDeathS, arrowDeathI, labelDeathI, arrowDeathR, labelDeathR].forEach(el => {
                if(el) el.style.opacity = 0; 
            });
        }

        function resetSimulation() {
            currentStep = 0;
            initializeIndividuals();
            hideAllFlows();
            if(explanationDiv) explanationDiv.innerHTML = '<p>Haz clic en "Siguiente Paso" para ver cómo se desarrolla la simulación, incluyendo nacimientos y muertes naturales.</p>';
            if(nextButton) nextButton.disabled = false;
        }

        function nextSirStep() {
            currentStep++;
            let explanationHTML = '';
            hideAllFlows(); 

            switch (currentStep) {
                case 1: 
                    explanationHTML = `<h4>Paso 1: Base Poblacional y Dinámica Vital</h4>
                        <p>Comenzamos con una población. Incluso sin la enfermedad específica, las poblaciones experimentan <span class="parameter-highlight">Nacimientos (Λ o B)</span>, que se suman a los Susceptibles, y <span class="parameter-highlight">Muertes Naturales (μ)</span>, que eliminan individuos de todos los compartimentos (S, I, R).</p>
                        <code class="equation">Entrada a S: Λ (Nacimientos)</code><code class="equation">Salida de cada compartimento X: μX</code>
                        <p>Visualizando estos procesos de fondo constantes:</p>`;
                    if(arrowBirthS) arrowBirthS.style.opacity = 1; 
                    if(labelBirthS) { labelBirthS.style.opacity = 1; labelBirthS.textContent = "Λ"; }
                    if(arrowDeathS) arrowDeathS.style.opacity = 1; 
                    if(labelDeathS) { labelDeathS.style.opacity = 1; labelDeathS.textContent = "μS"; }
                    if(arrowDeathI) arrowDeathI.style.opacity = 1; 
                    if(labelDeathI) { labelDeathI.style.opacity = 1; labelDeathI.textContent = "μI"; }
                    if(arrowDeathR) arrowDeathR.style.opacity = 1; 
                    if(labelDeathR) { labelDeathR.style.opacity = 1; labelDeathR.textContent = "μR"; }
                    
                    if (sContainer.children.length < 20) { 
                        sContainer.appendChild(createIndividualElement('susceptible'));
                    }
                    break;

                case 2: 
                    explanationHTML = `<h4>Paso 2: Introducción de la Infección (S → I)</h4>
                        <p>Ahora, una enfermedad infecciosa está presente. Los individuos Susceptibles (azules) se Infectan (rojos) por contacto efectivo con una persona infecciosa.</p>
                        <p>La tasa de este flujo S → I es impulsada por la <span class="parameter-highlight">Fuerza de Infección (λ)</span>.</p>
                        <code class="formula">λ = (β × I) / N</code><code class="equation">Flujo S → I : λS</code>
                        <p>Parámetro clave: <span class="parameter-highlight">β (Tasa de Transmisión)</span>.</p>`;
                    if(arrowSToI) arrowSToI.style.opacity = 1; 
                    if(labelSToI) { labelSToI.style.opacity = 1; labelSToI.textContent = "βSI/N"; }
                    if(arrowDeathS) arrowDeathS.style.opacity = 1; 
                    if(labelDeathS) { labelDeathS.style.opacity = 1; labelDeathS.textContent = "μS"; } 
                    if(arrowBirthS) arrowBirthS.style.opacity = 1; 
                    if(labelBirthS) { labelBirthS.style.opacity = 1; labelBirthS.textContent = "Λ"; } 

                    let infectionsThisStep = Math.min(sContainer.children.length, 2); 
                    if (sContainer.children.length > 0 && iContainer.children.length > 0 && infectionsThisStep > 0) {
                        for(let k=0; k < infectionsThisStep; k++) {
                            if (sContainer.children[0]) { iContainer.appendChild(sContainer.children[0]); }
                        }
                    }
                    break;

                case 3: 
                    explanationHTML = `<h4>Paso 3: Destino de los Infectados (I → R)</h4>
                        <p>Los individuos Infectados (rojos) no permanecen infectados para siempre. Se <span class="parameter-highlight">Recuperan (R)</span> (volviéndose verdes) a una cierta tasa.</p>
                        <p>El flujo I → R se rige por la <span class="parameter-highlight">Tasa de Recuperación (γ)</span>.</p>
                        <code class="formula">γ = 1 / D (Duración de la Infecciosidad)</code><code class="equation">Flujo I → R : γI</code>`;
                    if(arrowIToR) arrowIToR.style.opacity = 1; 
                    if(labelIToR) { labelIToR.style.opacity = 1; labelIToR.textContent = "γI"; }
                    if(arrowDeathI) arrowDeathI.style.opacity = 1; 
                    if(labelDeathI) { labelDeathI.style.opacity = 1; labelDeathI.textContent = "μI"; }
                    if(arrowSToI) arrowSToI.style.opacity = 1; 
                    if(labelSToI) { labelSToI.style.opacity = 1; labelSToI.textContent = "βSI/N"; }

                    let recoveriesThisStep = Math.min(iContainer.children.length, 1); 
                     if (iContainer.children.length > 0 && recoveriesThisStep > 0) {
                        for(let k=0; k < recoveriesThisStep; k++) {
                            if (iContainer.children[0]) { rContainer.appendChild(iContainer.children[0]); }
                        }
                    }
                    break;
                
                case 4: 
                     explanationHTML = `<h4>Paso 4: Dinámica Completa y Ecuaciones</h4>
                        <p>Todos estos procesos ocurren simultáneamente. Las ecuaciones completas del modelo SIR con dinámica vital son:</p>
                        <code class="equation">dS/dt = Λ - (βSI/N) - μS</code>
                        <code class="equation">dI/dt = (βSI/N) - γI - μI</code>
                        <code class="equation">dR/dt = γI - μR</code>
                        <p>Haz clic en 'Reiniciar' para observar de nuevo.</p>`;
                    
                    if(arrowBirthS) arrowBirthS.style.opacity = 1; 
                    if(labelBirthS) { labelBirthS.style.opacity = 1; labelBirthS.textContent = "Λ"; }
                    if(arrowSToI) arrowSToI.style.opacity = 1; 
                    if(labelSToI) { labelSToI.style.opacity = 1; labelSToI.textContent = "βSI/N"; }
                    if(arrowIToR) arrowIToR.style.opacity = 1; 
                    if(labelIToR) { labelIToR.style.opacity = 1; labelIToR.textContent = "γI"; }
                    if(arrowDeathS) arrowDeathS.style.opacity = 1; 
                    if(labelDeathS) { labelDeathS.style.opacity = 1; labelDeathS.textContent = "μS"; }
                    if(arrowDeathI) arrowDeathI.style.opacity = 1; 
                    if(labelDeathI) { labelDeathI.style.opacity = 1; labelDeathI.textContent = "μI"; }
                    if(arrowDeathR) arrowDeathR.style.opacity = 1; 
                    if(labelDeathR) { labelDeathR.style.opacity = 1; labelDeathR.textContent = "μR"; }
                    if(nextButton) nextButton.disabled = true; 
                    break;
                default: explanationHTML = "<p>Haz clic en 'Reiniciar' para comenzar.</p>"; if(nextButton) nextButton.disabled = true; break;
            }
            if(explanationDiv) explanationDiv.innerHTML = explanationHTML;
            sContainer.querySelectorAll('div > svg').forEach(svg => { if(!svg.classList.contains('susceptible')) {svg.classList.remove('infected', 'recovered'); svg.classList.add('susceptible');}});
            iContainer.querySelectorAll('div > svg').forEach(svg => { if(!svg.classList.contains('infected')) {svg.classList.remove('susceptible', 'recovered'); svg.classList.add('infected');}});
            rContainer.querySelectorAll('div > svg').forEach(svg => { if(!svg.classList.contains('recovered')) {svg.classList.remove('susceptible', 'infected'); svg.classList.add('recovered');}});
        }

        document.addEventListener('DOMContentLoaded', resetSimulation);

    </script>
</body>
</html>
